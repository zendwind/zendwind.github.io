<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# object: http://ogp.me/ns/object# article: http://ogp.me/ns/article# profile: http://ogp.me/ns/profile#">
<head>
  <meta charset="utf-8">
  <title>How to Deploy Airflow with Docker</title>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="keywords" content="Docker,Airflow,How to Deploy Airflow with Docker">
  <meta name="description" content="This post introduces how to deploy Airflow with Docker.">
   

  <meta name="og:type" content="article">
  <meta name="og:site_name" content="ZendWind's Blog and Project Site">
  <meta name="og:image" content="http://zendwind.com/image/logo.png">
  <meta name="og:title" content="How to Deploy Airflow with Docker">
  <meta name="og:url" content="http://zendwind.com/2020/04/04/en/airflow-docker-install/">
  <meta name="og:description" content="This post introduces how to deploy Airflow with Docker.">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="ZendWind's Blog and Project Site">
  <meta name="twitter:image" content="http://zendwind.com/image/logo.png">
  <meta name="twitter:title" content="How to Deploy Airflow with Docker">
  <meta name="twitter:creator" content="@JamlingLi">
  <meta name="twitter:description" content="This post introduces how to deploy Airflow with Docker.">

  <!-- Canonical links -->
  <link rel="canonical" href="http://zendwind.com/en/2020/04/04/en/airflow-docker-install/index.html">
  <!-- Alternative links -->
  <!-- CSS and JS-->
  <script src="//cdn.bootcss.com/jquery/2.2.0/jquery.min.js"></script>
<link rel="stylesheet" href="//cdn.bootcss.com/bootstrap/3.3.6/css/bootstrap.min.css">
<link rel="stylesheet" href="//cdn.bootcss.com/bootstrap/3.3.6/css/bootstrap-theme.min.css">
<script src="//cdn.bootcss.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
<script src="//cdn.bootcss.com/sidr/2.2.1/jquery.sidr.min.js"></script>
<script src="/js/jquery.bootstrap-autohidingnavbar.min.js"></script>
<script src="/js/script.js"></script>
<script src="/js/lang_select.js"></script>
<link rel="stylesheet" href="//cdn.bootcss.com/sidr/2.2.1/stylesheets/jquery.sidr.dark.min.css">
<link rel="stylesheet" href="//cdn.bootcss.com/highlight.js/9.15.10/styles/github.min.css">
<script src="//cdn.bootcss.com/highlight.js/9.15.10/highlight.min.js"></script>
<link rel="stylesheet" href="//cdn.jsdelivr.net/gh/tonsky/FiraCode@2/distr/fira_code.css">
<script src="//cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js"></script>
<link rel="stylesheet" href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css">
<link rel="stylesheet" href="//cdn.bootcss.com/fancybox/2.1.5/helpers/jquery.fancybox-buttons.css">
<script src="//cdn.bootcss.com/fancybox/2.1.5/helpers/jquery.fancybox-buttons.js"></script>
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/css/share.min.css">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.2/animate.min.css">
<link rel="stylesheet" href="/css/nova_font.css">
<link rel="stylesheet" href="/css/bs/nova.css">

  <!-- RSS -->
  <link rel="alternate" href="/atom.xml" title="Zend Wind's Blog">
  <link rel="shortcut icon" href="/image/favicon.ico" type="image/x-icon" />
</head>
<body>
  <!-- header -->
  <header id="body-header">
  <nav id="main-nav" class="navbar navbar-inverse navbar-fixed-top">
    <div class="container container-fluid">
      <!-- Brand and toggle get grouped for better mobile display -->
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse_" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a href="/en/" id="logo"><img src="/image/logo.png" height="50" alt="logo"></a>
      </div>
      <!-- Collect the nav links, forms, and other content for toggling -->
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
        <ul class="nav navbar-nav">
        <li><a href="/en/" class="main-nav">Home</a></li><li><a href="/en/p/" class="main-nav">Projects</a></li><li><a href="/en/categories/" class="main-nav">Category</a></li><li><a href="/en/archives/" class="main-nav">Archive</a></li><li><a href="/en/donate/" class="main-nav">Donate</a></li><li><a href="/en/about/" class="main-nav">About</a></li>
        </ul>
        <!-- search input -->
        

<!-- 百度站内搜索（已通过站点验证） -->
<form class="navbar-form navbar-left" role="search"
  action="//search.zendwind.com/cse/search">
  <div class="form-group search">
    <input type="text" name="q" id="bdcsMain" class="form-control primary" aria-label="..." placeholder="Search">
    <input type="hidden" name="s" value="11812712506721118476">
    <input type="hidden" name="nsid" value="0">
    <!-- 
    <input name="tn" type="hidden" value="SE_zzsearchcode_shhzc78w">
    <input name="cl" type="hidden" value="3">
    <input name="ct" type="hidden" value="2097152">
    <input name="si" type="hidden" value="ieclipse.cn">
    <input name="ie" type="hidden" value="utf-8">
    -->
  </div>
</form>

        <ul class="nav navbar-nav navbar-right">
          <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Language <span class="caret"></span></a>
            <ul class="dropdown-menu animated fadeInDown faster">
              <li><a href="/2020/04/04/en/airflow-docker-install/">简体中文</a></li>
              
              <li><a href="/en/2020/04/04/en/airflow-docker-install/">English</a></li>
              
            </ul>
          </li>
        </ul>
      </div>
    </div>
  </nav>
</header>

  <!-- main -->
  
<div class="container container-fluid">
<div class="row">
  <div class="col-sx-12 col-sm-8 col-md-9 col-lg-9">
    
<article class="article post" itemscope="itemscope" itemtype="http://schema.org/Article">
  <header class="article-header">
    <div class="page-path"><span class="post-category"><span class="glyphicon glyphicon-folder-close" aria-hidden="true"></span>Path: <a class="category-item" href="/en/">Blog</a><a class="category-item" href="/en/categories/Docker/">Docker</a></span></div>
    <div class="divider"></div>
      <h1 class="article-title" itemprop="name headline"></h1>
    <div class="post-header clearfix">
      <span class="post-date"><span class="hidden-xs icon nova-calendar">Post at: </span>
      <time datetime="2020-04-04T06:00:00.000Z" itemprop="datePublished"><time datetime="2020-04-04T06:00:00.000Z">2020-04-04</time></time>
      </span>
      
      <span class="post-share">
        <a href="#share" class="icon nova-share"><span class="hidden-xs">Share</span><span class="jiathis_counter_style"></span></a>
        <a href="#comment" class="icon nova-bubbles"><span class="ds-thread-count" id="changyan_count_unit" data-thread-key="32820168544d180a95b172581f8cf038"></span><span class="hidden-xs">Comment</span></a>
        <!--<a href="#like" class="icon nova-heart2-full"><span class="count" id="changyan_parti_unit"></span><span class="hidden-xs">Like</span></a>-->
        <a href="#" class="icon nova-eye"><span class="count lc-count"></span><span class="hidden-xs">Views</span></a>
      </span>
    </div>
    <div class="divider"></div>
    <meta content="2020-04-04T06:00:00.000Z" itemprop="datePublished">
  </header>
  <div class="article-content" itemprop="articleBody">
  
    <p>This post introduces how to deploy Airflow with Docker.<br><a id="more"></a></p>
<h1 id="Prerequisites"><a href="#Prerequisites" class="headerlink" title="Prerequisites"></a>Prerequisites</h1><ul>
<li>CentOS7 (64-bit)</li>
<li>TencentCloud CVM (4C,8G)</li>
<li>Python3.6.0<h1 id="Docker-Install"><a href="#Docker-Install" class="headerlink" title="Docker Install"></a>Docker Install</h1><h2 id="Docker-Install-1"><a href="#Docker-Install-1" class="headerlink" title="Docker Install"></a>Docker Install</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">yum install -y docker   #in centos8, yum install -y docker-ce</div><div class="line">systemctl start docker</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="Docker-Compose-Install"><a href="#Docker-Compose-Install" class="headerlink" title="Docker Compose Install"></a>Docker Compose Install</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"># download from github with curl</div><div class="line">curl -L https://github.com/docker/compose/releases/download/1.25.4/docker-compose-`uname -s`-`uname -m` -o /usr/local/bin/docker-compose</div><div class="line">chmod +x /usr/local/bin/docker-compose</div><div class="line"></div><div class="line">#install python module</div><div class="line">pip install docker-compose</div><div class="line"></div><div class="line">#check docker-compose version</div><div class="line">docker-compose version</div></pre></td></tr></table></figure>
<h2 id="Airflow-Docker-Install"><a href="#Airflow-Docker-Install" class="headerlink" title="Airflow Docker Install"></a>Airflow Docker Install</h2><ul>
<li><p>Pull from Repository</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker pull puckel/docker-airflow</div></pre></td></tr></table></figure>
</li>
<li><p>Download Git Package</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git clone https://github.com/puckel/docker-airflow.git</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="Airflow-LocalExecutor-Deploy"><a href="#Airflow-LocalExecutor-Deploy" class="headerlink" title="Airflow LocalExecutor Deploy"></a>Airflow LocalExecutor Deploy</h2><h3 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h3><p>The Airflow supports various deployment mode,  such as SequentialExecutor, LocalExecutor, CeleryExecutor, DaskExecutor, KubernetesExecutor.</p>
<ul>
<li>Airflow Local Executor Mode<br>Running Airflow on a LocalExecutor exemplifies single-node architecture. In dev or test environment, this mode is simple and easy for users to use Airflow.</li>
<li>Airflow CeleryExecutor Mode<br>Running Airflow on a CeleryExecutor exemplifies distributed architecture, and communicates with Celery. For production environment, this mode is popular for users to deploy.</li>
</ul>
<p>In this solution, only introduce how to deploy a LocalExecutor with docker.</p>
<h3 id="LocalExecutor-Deploy"><a href="#LocalExecutor-Deploy" class="headerlink" title="LocalExecutor Deploy"></a>LocalExecutor Deploy</h3><ul>
<li><p>Step 1. Modify airflow.cfg<br>Go into <code>docker-airflow/config</code> directory, open airflow.cfg and modify two items as below:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">#specify executor type</div><div class="line">executor = LocalExecutor</div><div class="line"></div><div class="line">#specify postgresql data source</div><div class="line">sql_alchemy_conn = postgresql+psycopg2://airflow:airflow@postgres:5432/airflow</div></pre></td></tr></table></figure>
</li>
<li><p>Step2. Modify Dockerfile<br>The dockerfile in puckel image is based on Debian and includes all of steps how to build the airflow docker image. So it’s unnecessary for you to rebuild the whole image, the simplified dockerfile is as below, which only contains basic steps.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">FROM puckel/docker-airflow:latest</div><div class="line">#RUN pip install --user psycopg2-binary</div><div class="line">ARG AIRFLOW_USER_HOME=/usr/local/airflow</div><div class="line">USER root</div><div class="line">#RUN pip install  xxx</div><div class="line">ENV AIRFLOW_HOME=/usr/local/airflow</div><div class="line">COPY config/airflow.cfg /usr/local/airflow/airflow.cfg</div><div class="line"></div><div class="line">RUN chown -R airflow: $&#123;AIRFLOW_USER_HOME&#125;</div><div class="line"></div><div class="line">EXPOSE 8080 5555 8793</div><div class="line"></div><div class="line">USER airflow</div><div class="line">WORKDIR $&#123;AIRFLOW_USER_HOME&#125;</div><div class="line">ENTRYPOINT [&quot;/entrypoint.sh&quot;]</div><div class="line">CMD [&quot;webserver&quot;]</div></pre></td></tr></table></figure>
</li>
<li><p>Step3. Modify docker-compose-LocalExecutor.yml<br>This file includes the containers we need to deploy, such as postgres and webserver. Meanwhile, specify the <code>volumes</code> for container.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line">version: &apos;3.7&apos;</div><div class="line">services:</div><div class="line">    postgres:</div><div class="line">        image: postgres:9.6</div><div class="line">        environment:</div><div class="line">            - POSTGRES_USER=airflow</div><div class="line">            - POSTGRES_PASSWORD=airflow</div><div class="line">            - POSTGRES_DB=airflow</div><div class="line">        ports:</div><div class="line">            - &quot;5432:5432&quot;</div><div class="line">        volumes:</div><div class="line">            - ./data/postgres:/var/lib/postgresql/data</div><div class="line">        logging:</div><div class="line">            options:</div><div class="line">                max-size: 10m</div><div class="line">                max-file: &quot;3&quot;</div><div class="line"></div><div class="line">    webserver:</div><div class="line">        image: puckel/docker-airflow:latest</div><div class="line">        restart: always</div><div class="line">        depends_on:</div><div class="line">            - postgres</div><div class="line">        environment:</div><div class="line">            - LOAD_EX=n</div><div class="line">            - EXECUTOR=Local</div><div class="line">        logging:</div><div class="line">            options:</div><div class="line">                max-size: 10m</div><div class="line">                max-file: &quot;3&quot;</div><div class="line">        volumes:</div><div class="line">            - ./dags:/usr/local/airflow/dags</div><div class="line">            # - ./plugins:/usr/local/airflow/plugins</div><div class="line">        ports:</div><div class="line">            - &quot;8080:8080&quot;</div><div class="line">        command: webserver</div><div class="line">        healthcheck:</div><div class="line">            test: [&quot;CMD-SHELL&quot;, &quot;[ -f /usr/local/airflow/airflow-webserver.pid ]&quot;]</div><div class="line">            interval: 30s</div><div class="line">            timeout: 30s</div><div class="line">            retries: 3</div></pre></td></tr></table></figure>
</li>
</ul>
<p><strong>Note</strong>: the image version of webserver need change to <code>latest</code> version</p>
<ul>
<li><p>Step4. Rebuild image</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cd puckel-docker-airflow</div><div class="line">docker build --rm -t puckel/docker-airflow .</div></pre></td></tr></table></figure>
</li>
<li><p>Step5. Deploy container</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cd puckel-docker-airflow</div><div class="line">docker-compose -f docker-compose-LocalExecutor.yml up -d</div></pre></td></tr></table></figure>
</li>
</ul>
<p>Then you can execute <code>docker ps</code> to get the container list.<br>If you want to restart container, such as webserver, the command is as below:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">docker-compose -f ./docker-compose-LocalExecutor.yml stop webserver</div><div class="line">docker-compose -f ./docker-compose-LocalExecutor.yml start webserver</div></pre></td></tr></table></figure></p>
<ul>
<li>Step6. Deploy Dag<br>Add a dag file (Python) in <code>dags</code> directory which is defined as volumes of <code>webserver</code> container in docker-compose-LocalExecutor.yml. Then, you can find it on the Airflow website.<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://localhost:8080</div></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="FAQ"><a href="#FAQ" class="headerlink" title="FAQ"></a>FAQ</h1><ol>
<li><code>airflow initdb</code> error: airflow.exceptions.AirflowException: Could not create Fernet object: Incorrect padding<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">python -c &quot;from cryptography.fernet import Fernet;print(Fernet.generate_key().decode())&quot;</div><div class="line">3vWG_GoK_2MtU1fqRwCKrfNVsKW-ZcpdP8Ltz51xm64=</div><div class="line"></div><div class="line">export AIRFLOW__CORE__FERNET_KEY=3vWG_GoK_2MtU1fqRwCKrfNVsKW-ZcpdP8Ltz51xm64=</div></pre></td></tr></table></figure>
</li>
</ol>

  
  </div>

  <script src="/js/decrypt.min.js"></script>
  <footer class="article-footer">
    <time class="article-footer-updated" datetime="2020-04-24T02:52:17.024Z" itemprop="dateModified">
    Last updated: 2020-04-24
    </time>
    <span itemprop="author publisher" itemscope="itemscope" itemtype="http://schema.org/Organization">
      <meta content="http://zendwind.com" itemprop="url">
      <meta content="ZendWind's Blog and Project Site" itemprop="name">
      <meta content="/image/logo.png" itemprop="logo">
    </span>
    
<a id="share"></a>
<div class="social-share"></div>
<script>
with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='//cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/js/social-share.min.js'];
</script>


  </footer>
</article>

<div class="page-footer">
  <nav><ul class="pager"><li class="previous"><a href="/en/2020/04/23/en/serverless-deploy-vuepress/"><span aria-hidden="true">&larr;</span><span class="hidden-xs">Prev</span></a></li><li class="next"><a href="/en/2020/03/28/en/dynamodb-migrate-s3/"><span aria-hidden="true">&rarr;</span><span class="hidden-xs">Next</span></a></li></ul></nav>
  
<!-- Button trigger modal -->
<blockquote class="donate"><!--
  <button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#DonateModal">
    Donate
  </button>-->
  <p>
  <a href="#" role="button" data-toggle="modal" data-target="#DonateModal">
  <img src="/image/donate_button.png" alt="donate">
  <span>Dear reader, if you feel this good, could you rewark me a `bread` as awark? Thank you very much~</span></a>
  </p>
</blockquote>
<!-- Modal -->
<div class="modal fade" id="DonateModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <span class="modal-title" id="myModalLabel">Donate</span>
      </div>
      <div class="modal-body"><!--
        <table>
        <thead>
          <th class="text-center">支付宝</th>
          <th class="text-center">微信支付</th>
        </thead>
        <tr>
          <td><img src="/image/donate_alipay.png" alt="使用支付宝扫码打赏" class="img-rounded donate" width="200" height="200"></td>
          <td><img src="/image/donate_wechat.png" alt="使用微信扫码打赏" class="img-rounded donate" width="200" height="200"></td>
        </tr>
        </table>-->
        <div class="container-fluid">
        <div class="row">
        <div class="col-md-6">
          <div class="text-center">
            <span style="display:block;">支付宝</span>
            <img src="/image/donate_alipay.png" alt="使用支付宝扫码打赏" class="donate" />
          </div>
        </div>
        <div class="col-md-6">
          <div class="text-center">
            <span style="display:block;">微信支付</span>
            <img src="/image/donate_wechat.png" alt="使用微信扫码打赏" class="donate" />
          </div>
        </div>
        </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

  <a id="comment"></a>

<script src="//unpkg.com/valine/dist/Valine.min.js">
</script>
<!--PC和WAP自适应版-->
<div id="vcomments" data-sid="32820168544d180a95b172581f8cf038" ></div>
<script>
    new Valine({
        el: '#vcomments',
        appId: 's7YiMwoKljbjEyiPSekMYxHW-gzGzoHsz',
        appKey: 'QdFr23RGUj3JYo0I4Yi8wuV3',
        path: '32820168544d180a95b172581f8cf038',
        recordIP: true
    })
</script>



</div>


    
  </div> <!-- end main column  -->
  <!-- aside -->
  <div class="col-sx-12 col-sm-4 col-md-3 col-lg-3">
    <aside>
      <div id="navbar-toc">
      <nav id="toc" class="hidden-print hidden-xs hidden-sm" data-spy="affix">
        <div class="toc-title"><a role="button" data-toggle="collapse" href="#toc-body" aria-expanded="true">
          Table Of Contents
        </a></div>
        <div id="toc-body" class="in">
        <ul class="nav toc-ul"><li><a href="#Prerequisites">Prerequisites</a></li><li><a href="#Docker-Install">Docker Install</a><ul class="nav toc-ul"><li><a href="#Docker-Install-1">Docker Install</a></li><li><a href="#Docker-Compose-Install">Docker Compose Install</a></li><li><a href="#Airflow-Docker-Install">Airflow Docker Install</a></li><li><a href="#Airflow-LocalExecutor-Deploy">Airflow LocalExecutor Deploy</a><ul class="nav toc-ul"><li><a href="#Introduction">Introduction</a></li><li><a href="#LocalExecutor-Deploy">LocalExecutor Deploy</a></li></ul></li></ul></li><li><a href="#FAQ">FAQ</a></li></ul>
        </div>
      </nav>
</div>

      
    </aside>
  </div> <!-- end aside column  -->
</div> <!-- end row -->
</div> <!-- end container -->

  <!-- footer -->
  <footer id="body-footer">
  <div class="divider"></div>
  <div>&nbsp;</div>
  <div class="inner text-center">
    <div id="footer-copyright">
      &copy; 2020 <a href="http://zendwind.com" target="_blank">Wen Qiuliang</a> powered by <a href="http://hexo.io" target="_blank">Hexo</a> Theme <a href="https://github.com/Jamling/hexo-theme-nova" target="_blank">Nova</a><br>
      <!-- Documentation licensed under <a href="http://creativecommons.org/licenses/by/4.0/" target="_blank">CC BY 4.0</a>. -->
    </div>
    <div>
      <a href="http://www.beian.miit.gov.cn" target="_blank"></a>
    </div>
  </div>
</footer>

  <!-- fixed action bar -->
  
  <div class="fab hidden-print" style="bottom: 45px; right: 24px;">
  <!--
    <ul class="top-expand" id="top-expand">
      <li><a class="fab-item large red" href="#top"><i class="icon nova-top"></i></a></li>
      <li><a class="fab-item large yellow " href="//www.jiathis.com/share?uid=2064663" target="_blank"><i class="icon nova-share"></i></a></li>
    </ul>
    <a class="fab-item large red " onclick="$('#top-expand').toggle();">
      <i class="icon nova-list-ul"></i>
    </a>
    -->
    <a class="fab-item large red " href="#top">
      <i class="icon nova-top"></i>
    </a>
  </div>

  <!-- after footer, some 3rd script place here -->
    <script>
    var hljs_labels = {
        left: "Code",
        right: ":",
        copy: "Copy to clipboard"
    }
    </script>
    <script src="/js/hljs.js"></script>
    <script src="/js/script.js"></script>
    
    <!-- 安装自动推送JS代码的网页，在页面被访问时，页面URL将立即被推送给百度 -->
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>

    <!-- 新建的搜索框代码，建立使用你自己的代码替换-->
<script>
(function(){document.write(unescape('%3Cdiv id="bdcs"%3E%3C/div%3E'));var bdcs = document.createElement('script');bdcs.type = 'text/javascript';bdcs.async = true;bdcs.src = 'http://znsv.baidu.com/customer_search/api/js?sid=11812712506721118476' + '&plate_url=' + encodeURIComponent(window.location.href) + '&t=' + Math.ceil(new Date()/3600000);var s = document.getElementsByTagName('script')[0];s.parentNode.insertBefore(bdcs, s);})();
</script>

    

<!-- LeanClound官方Javascript SDK -->
<script>
  var page_layout = 'false'
  var lc_debug = false;
  if(typeof AV === 'undefined') {
    $.getScript('//cdn1.lncld.net/static/js/av-min-1.2.1.js',function() {
      lc_debug && console.log('init AV after av.js loaded');
        AV.init({
          appId : 's7YiMwoKljbjEyiPSekMYxHW-gzGzoHsz',
          appKey : 'QdFr23RGUj3JYo0I4Yi8wuV3'
        });
        if (page_layout === 'true') {
          lc_index_views('.card-action', {
            style : 'hidden-xs',
            p : {
              views : '.nova-eye .count'
            }
          })
        }
        lc_page_views();
    });
  }

  var lc_config = {
    pageId : '32820168544d180a95b172581f8cf038',
    url : 'en/2020/04/04/en/airflow-docker-install/' || 'http://zendwind.com/2020/04/04/en/airflow-docker-install/',
    title : 'How to Deploy Airflow with Docker'
  };
  lc_debug && console.log('lcconfig', lc_config);

  var lc_table = 'Counter' || 'Counter';

  function lc_page_views() {
    var query = new AV.Query(lc_table);
    query.select(['-ACL']);
    query.equalTo('pageId', lc_config.pageId);
    query.first({
      success: function(results) {
        // results is an array of AV.Object.
        if (typeof results === 'undefined') {
          insert(results);
          return;
        }
        update(results);
        show(results);
      },
      error: function(error) {
        // error is an instance of AV.Error.
        console.log(error);
      }
    });

    function insert(data) {
      if (!data) {
        lc_debug && console.log('data is null new object');
        var M = AV.Object.extend(lc_table);
        data = new M();
        data.set('views', 1);
      }
      for ( var key in lc_config) {
        data.set(key, lc_config[key]);
      }
      data.save().then(function(data) {
        lc_debug && console.log('created objectId is ' + data.id);
      }, function(error) {
        lc_debug && console.log("create object failed", error);
      });
    }

    function update(data) {
      for ( var key in lc_config) {
        if (key !== 'pageId')
        data.set(key, lc_config[key]);
      }
      lc_debug && console.log("after change,data", data);
      data.increment('views', 1);
      data.save().then(function(data) {
        lc_debug && console.log("update to " + data.get('views'));
      }, function(error) {
        lc_debug && console.log("update object failed", error);
      });
    }

    function show(data) {
      $(".lc-count").html(data.get('views'));
    }
    function show_count(count) {
      $(".lc-count").html(count);
    }
  };

  function lc_index_views() {
    // load views count from leanclound
    // make sure you are created Counter table on leanclound
    function lc_load_views(selector, options) {
      var o = options || {};
      var tkeys = [];
      $(selector).each(function(i) {
        var tkey = $(this).data('tkey');
        tkeys.push(tkey);
      });

      var query = new AV.Query(lc_table);
      query.select([ '-ACL', '-createdAt', '-updatedAt', '-url' ]);
      query.containedIn('pageId', tkeys);
      query.find().then(function(results) {
        $(selector).each(function(i) {
          var tkey = $(this).data('tkey');
          for (var i = 0; i < results.length; i++) {
            var t = results[i];
            if (t.get('pageId') === tkey) {
              var c = t.get('views') + '';
              $(this).find(o.p.views).html(c);
            }
          }
        });
      }, function(error) {
      });
    }

    lc_load_views('.card-action', {
      style : 'hidden-xs',
      p : {
        views : '.nova-eye .count'
      }
    });
  }
</script>

</body>
</html>
